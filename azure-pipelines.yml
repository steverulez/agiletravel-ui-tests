# Ruby
# Package your Ruby project.
# Add steps that install rails, analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/ruby

trigger:
- master

strategy:
  matrix:
    linux-chrome:
      imageName: 'ubuntu-16.04'
      browser: chrome

pool:
  vmImage: $(imageName)

steps:
- task: UseRubyVersion@0
  inputs:
    versionSpec: '>= 2.5'

- task: PowerShell@2
  inputs:
    targetType: 'inline'
    script: |
      Copy-Item "$(System.DefaultWorkingDirectory)/spec/chromedriver" -Destination "$(System.DefaultWorkingDirectory)/selenium-webdriver-rspec/spec/"
      chmod +x $(System.DefaultWorkingDirectory)/selenium-webdriver-rspec/spec/chromedriver

- script: |
    gem install bundler
    bundle install --retry=3 --jobs=4 --gemfile=selenium-webdriver-rspec/Gemfile
  displayName: 'bundle install'

- script: bundle exec rake -f Rakefile ci:ui_tests:quick
  displayName: 'bundle exec rake'
  workingDirectory: selenium-webdriver-rspec
